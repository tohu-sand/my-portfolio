---
import type { CollectionEntry } from "astro:content";
import { idToSlug } from "../utils/slug";
import { formatDateJP } from "../utils/date";

interface Props {
  entry: CollectionEntry<"gallery">;
}

const { entry } = Astro.props;
const { slug, data } = entry;
const resolvedSlug = slug || idToSlug(entry.id);
const dateStr = formatDateJP(data.date);
---
<figure class="group h-full">
  <a href={`/gallery/${resolvedSlug}/`} class="flex h-full flex-col rounded-xl border border-stone-200 dark:border-stone-700 overflow-hidden bg-white dark:bg-stone-800 shadow transition-shadow hover:shadow-lg dark:shadow-stone-900/50 dark:hover:shadow-stone-900/70">
    <div class="relative h-48 overflow-hidden">
      <img
        src={data.thumbnail}
        alt={data.title}
        class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
        loading="lazy"
      />
      <span class="absolute inset-0 bg-black/30 opacity-0 transition-opacity duration-300 group-hover:opacity-100" aria-hidden="true"></span>
    </div>
    <figcaption class="flex flex-col p-4 text-sm leading-tight">
      <span class="line-clamp-2 font-medium text-stone-900 dark:text-stone-100">{data.title}</span>
      <time datetime={data.date.toISOString()} class="mt-1 text-xs text-stone-500 dark:text-stone-400">{dateStr}</time>
    </figcaption>
  </a>
</figure>
