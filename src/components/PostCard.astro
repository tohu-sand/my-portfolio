---
import type { CollectionEntry } from "astro:content";
import { idToSlug } from "../utils/slug";
import { formatDateJP } from "../utils/date";

interface Props {
  entry: CollectionEntry<"posts"> | CollectionEntry<"gallery">;
}

const { entry } = Astro.props;
const { data, slug } = entry;
const resolvedSlug = slug || idToSlug(entry.id);
const dateStr = formatDateJP(data.date);

// コレクションの種類を判定
const isGallery = entry.collection === "gallery";
const typeLabel = isGallery ? "ギャラリー" : "ブログ";
const baseUrl = isGallery ? "/gallery/" : "/blog/";
---
<article class="border border-stone-200 dark:border-stone-700 rounded-xl overflow-hidden shadow hover:shadow-lg dark:shadow-stone-900/50 dark:hover:shadow-stone-900/70 transition bg-white dark:bg-stone-800">
  <a href={`${baseUrl}${resolvedSlug}/`}>
    <img
      src={data.thumbnail}
      alt={data.title}
      class="w-full h-40 object-cover"
      loading="lazy"
    />
    <div class="p-4">
      <h3 class="text-lg font-semibold line-clamp-2 text-stone-900 dark:text-stone-100">{data.title}</h3>
  <p class="mt-1 text-sm text-stone-600 dark:text-stone-400">{dateStr} - {typeLabel}</p>
      {"excerpt" in data && data.excerpt && <p class="mt-2 text-sm line-clamp-2 text-stone-700 dark:text-stone-300">{data.excerpt}</p>}
    </div>
  </a>
</article>
